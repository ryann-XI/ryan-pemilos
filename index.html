<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pemilihan Ketua OSIS</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#0e1624;
  display:flex;
  justify-content:center;
  padding:20px;
  color:white;
}

.container{
  width:100%;
  max-width:900px;
  display:flex;
  gap:20px;
}

.panel{
  flex:1;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(10px);
  border:1px solid rgba(255,255,255,0.15);
  padding:20px;
  border-radius:15px;
}

input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-bottom:12px;
  background:rgba(255,255,255,0.15);
  color:white;
}

.candidate{
  background:rgba(255,255,255,0.12);
  border:1px solid rgba(255,255,255,0.15);
  padding:12px;
  border-radius:10px;
  margin-bottom:10px;
  cursor:pointer;
}

.candidate.selected{
  border:1px solid #6da3ff;
  background:rgba(110,160,255,0.25);
}

button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  background:linear-gradient(90deg,#7a57ff,#3f8aff);
  color:white;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}

.bar{
  height:10px;
  border-radius:20px;
  background:rgba(255,255,255,0.15);
  overflow:hidden;
}

.bar i{
  display:block;
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#7a57ff,#3f8aff);
  transition:.6s;
}
</style>
</head>
<body>

<div class="container">

  <div class="panel">
    <h2>Pemilihan Ketua OSIS</h2>

    <input id="fullname" placeholder="Nama Lengkap">
    <input id="kelas" placeholder="Kelas">

    <div id="candidateList"></div>

    <button id="voteBtn">Kirim Suara</button>
  </div>

  <div class="panel">
    <h2>Hasil Voting</h2>
    <div id="results"></div>
    <div style="margin-top:10px">Total: <span id="total">0</span></div>
  </div>

</div>

<script>
const CANDIDATES=[
  {id:"arini",name:"Arini Ataka"},
  {id:"kaka",name:"Kaka Dwi"},
  {id:"bagus",name:"Bagus"}
];

const STORAGE="votes_v2";
const STORAGE_FLAG="voted_v2";

const fullname=document.getElementById("fullname");
const kelas=document.getElementById("kelas");
const voteBtn=document.getElementById("voteBtn");
const candidateList=document.getElementById("candidateList");
const results=document.getElementById("results");
const totalEl=document.getElementById("total");

function readVotes(){
  const r=localStorage.getItem(STORAGE);
  if(!r){
    const init={arini:0,kaka:0,bagus:0};
    localStorage.setItem(STORAGE,JSON.stringify(init));
    return init;
  }
  return JSON.parse(r);
}

function writeVotes(v){
  localStorage.setItem(STORAGE,JSON.stringify(v));
}

function renderCandidates(){
  candidateList.innerHTML="";
  CANDIDATES.forEach(c=>{
    const div=document.createElement("div");
    div.className="candidate";
    div.textContent=c.name;
    div.dataset.id=c.id;

    div.onclick=()=>{
      document.querySelectorAll(".candidate").forEach(e=>e.classList.remove("selected"));
      div.classList.add("selected");
    };

    candidateList.appendChild(div);
  });
}

function renderResults(){
  const v=readVotes();
  const total=v.arini+v.kaka+v.bagus;

  results.innerHTML="";

  CANDIDATES.forEach(c=>{
    const t=document.createElement("div");
    t.textContent=`${c.name} (${v[c.id]})`;

    const bar=document.createElement("div");
    bar.className="bar";

    const fill=document.createElement("i");
    bar.appendChild(fill);

    results.appendChild(t);
    results.appendChild(bar);

    setTimeout(()=> fill.style.width=total?(v[c.id]/total*100)+"%":"0%",50);
  });

  totalEl.textContent=total;
}

function submitVote(id){
  if(localStorage.getItem(STORAGE_FLAG)){
    alert("Sudah pernah voting");
    return;
  }

  const v=readVotes();
  v[id]++;
  writeVotes(v);
  localStorage.setItem(STORAGE_FLAG,"1");

  renderResults();
  document.querySelectorAll("button,input,.candidate").forEach(e=>e.disabled=true);

  document.querySelector(".panel:nth-child(2)").scrollIntoView({behavior:"smooth"});
}

voteBtn.onclick=()=>{
  const selected=document.querySelector(".candidate.selected");
  if(!fullname.value||!kelas.value||!selected){
    alert("Lengkapi data & pilih kandidat!");
    return;
  }
  submitVote(selected.dataset.id);
};

renderCandidates();
renderResults();
</script>

</body>
</html>
