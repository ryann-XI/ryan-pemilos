<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pemilihan Ketua OSIS</title>

<style>
*{
  box-sizing:border-box;
}

body{
  margin:0;
  font-family: 'Segoe UI', sans-serif;
  background:linear-gradient(135deg,#0b1220,#141d2e);
  display:flex;
  justify-content:center;
  padding:20px;
  color:white;
}

.container{
  width:100%;
  max-width:600px;
  display:flex;
  flex-direction:column;
  gap:20px;
}

.panel{
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(15px);
  border:1px solid rgba(255,255,255,0.15);
  padding:20px;
  border-radius:18px;
  box-shadow:0 8px 25px rgba(0,0,0,0.25);
  animation:fade .4s ease;
}

@keyframes fade{
  from{opacity:0;transform:translateY(10px);}
  to{opacity:1;transform:translateY(0);}
}

h2{
  text-align:center;
  margin-top:0;
  font-weight:600;
  letter-spacing:.5px;
}

input{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  margin-bottom:14px;
  background:rgba(255,255,255,0.15);
  color:white;
  font-size:15px;
  outline:none;
}

input:focus{
  background:rgba(255,255,255,0.22);
}

.candidate{
  background:rgba(255,255,255,0.12);
  border:1px solid rgba(255,255,255,0.15);
  padding:14px;
  border-radius:12px;
  margin-bottom:10px;
  cursor:pointer;
  transition:.25s;
}

.candidate:hover{
  background:rgba(255,255,255,0.20);
}

.candidate.selected{
  border:1px solid #6da3ff;
  background:rgba(110,160,255,0.25);
}

button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  background:linear-gradient(90deg,#6f79ff,#3fa8ff);
  color:white;
  font-weight:bold;
  cursor:pointer;
  font-size:16px;
  transition:.25s;
}

button:hover{
  opacity:.9;
  transform:scale(.98);
}

.bar{
  height:12px;
  border-radius:20px;
  background:rgba(255,255,255,0.15);
  overflow:hidden;
  margin-bottom:10px;
}

.bar i{
  display:block;
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#6f79ff,#3fa8ff);
  transition:.6s;
}

.result-name{
  font-size:14px;
  margin-bottom:4px;
}
</style>
</head>
<body>

<div class="container">

  <div class="panel">
    <h2>Pemilihan Ketua OSIS</h2>

    <input id="fullname" placeholder="Nama Lengkap">
    <input id="kelas" placeholder="Kelas">

    <div id="candidateList"></div>

    <button id="voteBtn">Kirim Suara</button>
  </div>

  <div class="panel">
    <h2>Hasil Voting</h2>
    <div id="results"></div>
    <div style="margin-top:10px;text-align:center;font-size:14px;">
      Total Suara: <span id="total">0</span>
    </div>
  </div>

</div>

<script>
const CANDIDATES=[
  {id:"arini",name:"Arini Ataka"},
  {id:"kaka",name:"Kaka Dwi"},
  {id:"bagus",name:"Bagus"}
];

const STORAGE="votes_final";
const STORAGE_FLAG="voted_final";

const fullname=document.getElementById("fullname");
const kelas=document.getElementById("kelas");
const voteBtn=document.getElementById("voteBtn");
const candidateList=document.getElementById("candidateList");
const results=document.getElementById("results");
const totalEl=document.getElementById("total");

function readVotes(){
  const r=localStorage.getItem(STORAGE);
  if(!r){
    const init={arini:0,kaka:0,bagus:0};
    localStorage.setItem(STORAGE,JSON.stringify(init));
    return init;
  }
  return JSON.parse(r);
}

function writeVotes(v){
  localStorage.setItem(STORAGE,JSON.stringify(v));
}

function renderCandidates(){
  candidateList.innerHTML="";
  CANDIDATES.forEach(c=>{
    const div=document.createElement("div");
    div.className="candidate";
    div.textContent=c.name;
    div.dataset.id=c.id;

    div.onclick=()=>{
      document.querySelectorAll(".candidate").forEach(e=>e.classList.remove("selected"));
      div.classList.add("selected");
    };

    candidateList.appendChild(div);
  });
}

function renderResults(){
  const v=readVotes();
  const total=v.arini+v.kaka+v.bagus;

  results.innerHTML="";

  CANDIDATES.forEach(c=>{
    const wrapper=document.createElement("div");

    const t=document.createElement("div");
    t.className="result-name";
    t.textContent=`${c.name} (${v[c.id]})`;

    const bar=document.createElement("div");
    bar.className="bar";
    const fill=document.createElement("i");
    bar.appendChild(fill);

    wrapper.appendChild(t);
    wrapper.appendChild(bar);
    results.appendChild(wrapper);

    setTimeout(()=> fill.style.width=total?(v[c.id]/total*100)+"%":"0%",50);
  });

  totalEl.textContent=total;
}

function submitVote(id){
  if(localStorage.getItem(STORAGE_FLAG)){
    alert("Anda sudah melakukan voting");
    return;
  }

  const v=readVotes();
  v[id]++;
  writeVotes(v);
  localStorage.setItem(STORAGE_FLAG,"1");

  renderResults();

  document.querySelector(".panel:nth-child(2)").scrollIntoView({behavior:"smooth"});
}

voteBtn.onclick=()=>{
  const selected=document.querySelector(".candidate.selected");
  if(!fullname.value||!kelas.value||!selected){
    alert("Lengkapi data & pilih kandidat!");
    return;
  }
  submitVote(selected.dataset.id);
};

renderCandidates();
renderResults();
</script>

</body>
</html>
